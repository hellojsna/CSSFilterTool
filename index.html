<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSFilterTool</title>
    <style>
        html,
        body {
            width: 100dvw;
            height: 100dvh;
            margin: 0;
            padding: 0;
        }
        h1, h2, h3, h4, h5, h6, p {
            margin: 0;
            padding: 0;
        }
        #MenuContainer {
            padding: 1rem;
            box-sizing: border-box;
            height: fit-content;
        }
        #FilterListView {
            display: flex;
            gap: 0.5rem;
            overflow-x: scroll;
            margin-bottom: 1rem;
        }
        #MenuContainer button {
            border: none;
            background-color: #1c1c1e;
            color: #ffffff;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin: 0.5rem 0;
            cursor: pointer;
        }
        #MenuContainer button.selected {
            background-color: #007aff;
        }

        #AppliedFilterContainer {
            margin-bottom: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        #AppliedFilterContainer > span {
            width: 100%;
            height: 5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        #AppliedFilterContainer > span > span {
            display: block;
            width: 100%;
            height: 100%;
            white-space: nowrap;
            border: 1px solid#1c1c1e;
            overflow: scroll;
        }

        #MenuContainer input {
            border: 1px solid #1c1c1e;
            padding: 0.5rem 1rem;
            border-radius: 5px;
        }
        #FilterDescriptionContainer {
            margin-bottom: 1rem;
        }
        #MainWorkspace {
            display: flex;
            width: 100%;
            height: 70dvh;
            padding: 1rem;
            box-sizing: border-box;
            bottom: 0;
        }

        #MainWorkspace>div {
            width: 50%;
        }

        #MainWorkspace #FilterPreviewImage {
            width: 100%;
            height: 100%;
            max-height: 90dvh;
            object-fit: cover;
        }
        a {
            color: blue;
            text-decoration: none;
        }

        #MainWorkspace #FilterPreviewOverlayContainer {
            position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            bottom: 0;
            margin: 0;
            width: 100dvw;
            height: 70dvh;
            pointer-events: none;
        }
        #MainWorkspace #FilterPreviewOverlay {
            background-color: #4D561355;
            padding: 2rem;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
        }
    </style>
</head>

<body>
    <div id="MenuContainer">
        <!--<button id="ExportButton">Export CSS</button>--> <!-- 실시간으로 CSS 보여줘서 필요 없음. -->
        <div id="AppliedFilterContainer">
            <h2>Applied Filters:</h2>
            <span id="AppliedFilterList">
                <span>
                    <h3>Text Filter</h3>
                    <span id="Applied-FilterPreviewTextContainer"></span>
                </span>
                <span>
                    <h3>Image Filter</h3>
                    <span id="Applied-FilterPreviewImageContainer"></span>
                </span>
                <span>
                    <h3>Overlay Filter</h3>
                    <span id="Applied-FilterPreviewOverlay"></span>
                </span>
            </span>
            <span id="AppliedBackdropFilterList">
                <span>
                    <h3>Text Backdrop Filter</h3>
                    <span id="AppliedBackdrop-FilterPreviewTextContainer"></span>
                </span>
                <span>
                    <h3>Image Backdrop Filter</h3>
                    <span id="AppliedBackdrop-FilterPreviewImageContainer"></span>
                </span>
                <span>
                    <h3>Overlay Backdrop Filter</h3>
                    <span id="AppliedBackdrop-FilterPreviewOverlay"></span>
                </span>
            </span>
        </div>
        <div id="FilterListView">
            <button id="blur">Blur</button>
            <button id="brightness">Brightness</button>
            <button id="contrast">Contrast</button>
            <button id="drop-shadow">Drop Shadow</button>
            <button id="grayscale">Grayscale</button>
            <button id="hue-rotate">Hue Rotate</button>
            <button id="invert">Invert</button>
            <button id="opacity">Opacity</button>
            <button id="saturate">Saturate</button>
            <button id="sepia">Sepia</button>
        </div>
        <div id="FilterValueInputContainer">
            <input type="text" id="FilterValueInput" value="">
            <input type="checkbox" id="FilterTargetText" name="FilterTarget" value="FilterPreviewTextContainer" checked><label for="FilterTargetText">Text</label>
            <input type="checkbox" id="FilterTargetImage" name="FilterTarget" value="FilterPreviewImageContainer" checked><label for="FilterTargetImage">Image</label>
            <input type="checkbox" id="FilterTargetOverlay" name="FilterTarget" value="FilterPreviewOverlay"><label for="FilterTargetOverlay">Overlay</label>
            <input type="radio" id="FilterMode" name="FilterMode" checked><label for="FilterMode">filter</label>
            <input type="radio" id="FilterModeBackdrop" name="FilterMode"><label for="FilterModeBackdrop">backdrop-filter</label>
        </div>
        <div id="FilterDescriptionContainer">
            <h2 id="FilterName">Select a Filter</h2>
            <p id="FilterDescription">Description of the selected filter will appear here. You can change the filter value using the input below and see the changes in real-time.</p>
            <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/filter-function">Check MDN for more info.</a>
        </div>
    </div>
    <div id="MainWorkspace">
        <div id="FilterPreviewTextContainer">
            <h1>Filter Preview</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua.</p>
            <p style="color: red;">동해물과 백두산이 마르고 닳도록 하느님이 보우하사 우리나라 만세</p>
            <p style="color: green;">초록빛 고래수염과 높이뛰는 황새다리건널목 신호등 아래 솜사탕우주맛집</p>
            <p style="color: blue;"><a href="https://jsna.dev">Hello, Js Na! - Made by Js Na with ❤️</a></p>
            <p style="color: cyan;">The quick brown fox jumps over the lazy dog.</p>
            <p style="color: magenta;">Who wants a stylus? You have to get 'em and put 'em away, and you lose 'em. Yuck. Nobody wants a stylus.</p>
            <p style="color: yellow;">이번 역은 4호선, 경의·중앙선, 공항철도, GTX-A 열차로 갈아타실 수 있는 서울역, 서울역입니다. 내리실 문은 오른입니다.</p>
            <p style="color: brown;">本日も阪急電車をご利用いただきまして、ありがとうございます。大阪梅田、大阪梅田、終点です。</p>
            <p style="color: teal;">Thank you for riding with us! This train is bound for Yumeshima.</p>
            <p>How about emojis?</p>
            <h1 style="font-size: 3rem;">🐱😈🙃☕️🍝👏🧵🤍🖤🍫</h1>
            <h1 style="font-size: 3rem; background: linear-gradient(to right, red, blue);">G r a d i e n t s</h1>
        </div>
        <div id="FilterPreviewImageContainer">
            <img id="FilterPreviewImage" src="./PreviewImage.webp">
        </div>
        <div id="FilterPreviewOverlayContainer">
            <div id="FilterPreviewOverlay">
                This is an element on top of the preview area.
                Try changing backdrop-filter and filter to see the differences.
            </div>
        </div>
    </div>
    <script>
        // JavaScript code to handle filter application and export
        const filterValues = {};
        const backdropFilterValues = {};

        const FilterDescription = {
            "blur": "blur(px) Applies a Gaussian blur. Can be adjusted with a pixel value.",
            "brightness": "brightness(%) Adjusts the brightness of the element. 100% is normal. Values greater than 100% make it brighter, while values less than 100% make it darker.",
            "contrast": "contrast(%) Adjusts the contrast of the element. 100% is normal. Values greater than 100% increase contrast, while values less than 100% decrease contrast.",
            "drop-shadow": "drop-shadow(offsetX offsetY blurRadius color) Applies a drop shadow effect. Requires offsetX, offsetY, blurRadius, and color values.",
            "grayscale": "grayscale(%) Converts the element to grayscale. 0% is fully colored, while 100% is completely grayscale. Negative values are not allowed.",
            "hue-rotate": "hue-rotate(deg) Applies a hue rotation to the element. The angle is specified in degrees. 0deg is default(original color), 360deg is maximum.",
            "invert": "invert(%) Inverts the colors of the element. 0% is normal, while 100% is completely inverted. Negative values are not allowed.",
            "opacity": "opacity(%) Adjusts the opacity of the element. 100% is fully opaque, while 0% is fully transparent. Values greater than 100% or negative are not allowed.",
            "saturate": "saturate(%) Adjusts the saturation of the element. 100% is normal, values greater than 100% increase saturation, and values less than 100% decrease saturation. Negative values are not allowed.",
            "sepia": "sepia(%) Applies a sepia filter to the element. 0% is normal, while 100% is completely sepia. Negative values are not allowed."
        }
        const FilterDefaults = {
            "blur": "0px",
            "brightness": "100%",
            "contrast": "100%",
            "drop-shadow": "0 0 0 transparent",
            "grayscale": "0%",
            "hue-rotate": "0deg",
            "invert": "0%",
            "opacity": "100%",
            "saturate": "100%",
            "sepia": "0%"
        }
        let currentFilter = null;

        const filterDescriptionName = document.getElementById('FilterName');
        const filterDescriptionText = document.getElementById('FilterDescription');
        const filterPreviewText = document.getElementById('FilterPreviewTextContainer');
        const filterPreviewImage = document.getElementById('FilterPreviewImage');
        const filterValueInput = document.getElementById('FilterValueInput');
        const exportButton = document.getElementById('ExportButton');

        const filterTargetCheckboxes = document.querySelectorAll('input[name="FilterTarget"]');
        const filterModeRadioButtons = document.querySelectorAll('input[name="FilterMode"]');

        let selectedTargets = ['FilterPreviewTextContainer', 'FilterPreviewImageContainer'];

        function clearFilterSelection() {
            filterValueInput.value = '';
            if (currentFilter) {
                const selectedBtn = document.getElementById(currentFilter);
                if (selectedBtn) selectedBtn.classList.remove('selected');
            }
            currentFilter = null;
            filterDescriptionName.textContent = 'Select a Filter';
            filterDescriptionText.textContent = 'Description of the selected filter will appear here. You can change the filter value using the input below and see the changes in real-time.';
        }

        function changeTarget() {
            selectedTargets = Array.from(document.querySelectorAll('input[name="FilterTarget"]:checked')).map(input => input.value);
            clearFilterSelection();
            console.log('Selected targets:', selectedTargets);
        }
        function getTargetElements() {
            return selectedTargets.map(target => document.getElementById(target));
        }

        let backdropFilterMode = false;

        function changeFilterMode() {
            backdropFilterMode = document.getElementById('FilterModeBackdrop').checked;
            console.log('Filter mode changed. Backdrop mode:', backdropFilterMode);
            clearFilterSelection();
            updateFilters();
        }
        function getFilterString(target, isBackdrop = false) {
            const values = isBackdrop ? backdropFilterValues[target] : filterValues[target];
            if (!values) return '';
            return Object.entries(values)
                .map(([filter, value]) => `${filter}(${value})`)
                .join(' ');
        }

        function updateFilters() {
            const isBackdrop = backdropFilterMode;
            getTargetElements().forEach(element => {
                const id = element.id;
                const filterStr = getFilterString(id, isBackdrop);
                if (isBackdrop) {
                    element.style.backdropFilter = filterStr;
                    document.getElementById(`AppliedBackdrop-${id}`).textContent = element.style.backdropFilter;
                } else {
                    element.style.filter = filterStr;
                    document.getElementById(`Applied-${id}`).textContent = element.style.filter;
                }
            });
        }

        
        function updateFilterValue() {
            if (!currentFilter) return;
            const value = filterValueInput.value || FilterDefaults[currentFilter];
            const isBackdrop = backdropFilterMode;
            getTargetElements().forEach(element => {
                const id = element.id;
                if (isBackdrop) {
                    if (!backdropFilterValues[id]) backdropFilterValues[id] = {};
                    backdropFilterValues[id][currentFilter] = value;
                } else {
                    if (!filterValues[id]) filterValues[id] = {};
                    filterValues[id][currentFilter] = value;
                }
            });
            updateFilters();
        }

        document.getElementById('FilterListView').addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                if (currentFilter) document.getElementById(currentFilter).classList.remove('selected');
                e.target.classList.add('selected');
                currentFilter = e.target.id;
                const firstTarget = getTargetElements()?.id;
                if (backdropFilterMode) {
                    filterValueInput.value =
                        (backdropFilterValues[firstTarget]?.[currentFilter]) || FilterDefaults[currentFilter];
                } else {
                    filterValueInput.value =
                        (filterValues[firstTarget]?.[currentFilter]) || FilterDefaults[currentFilter];
                }
                filterDescriptionName.textContent = currentFilter;
                filterDescriptionText.textContent = FilterDescription[currentFilter];
                console.log(`Selected filter: ${currentFilter}`);
            }
        });

        filterValueInput.addEventListener('input', () => {
            updateFilterValue();
        });

        filterTargetCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', changeTarget);
        });

        filterModeRadioButtons.forEach(radio => {
            radio.addEventListener('change', changeFilterMode);
        });
    </script>
</body>

</html>